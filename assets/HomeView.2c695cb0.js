var O=Object.defineProperty;var j=(e,t,s)=>t in e?O(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var D=(e,t,s)=>(j(e,typeof t!="symbol"?t+"":t,s),s);import{t as E,c as Y,u as q,B as z,a as L,_ as R}from"./index.4519b5e8.js";import{_ as G,a as Q}from"./BillItem.vue_vue_type_script_setup_true_lang.da35ed73.js";import{m as V,r as x,w as J,q as h,t as _,G as p,c as B,o as K,v as m,k as b,u as g,B as C,z as T,I as P}from"./@vue.6b771be9.js";import{d as l}from"./dayjs.8eec1a0d.js";import"./vue-router.c17ffd82.js";import"./dexie.a92c4e2b.js";import"./uuid.fbc3d34b.js";import"./@vueuse.3609b986.js";import"./vue-i18n.a532ecf1.js";import"./@intlify.03657722.js";import"./lodash-es.94cbcf30.js";const U=(e,t,s,o)=>s*e/o+t,W={easeIn(e,t,s,o){return s*(e/=o)*e*e*e+t},easeOut(e,t,s,o){return-s*((e=e/o-1)*e*e*e-1)+t},easeInOut(e,t,s,o){return(e/=o/2)<1?s/2*e*e*e*e+t:-s/2*((e-=2)*e*e*e-2)+t}};class X{constructor(t,s,o,u=()=>{},c=U){D(this,"runner");this.from=t,this.to=s,this.duration=o,this.callback=u,this.curve=c}start(){let s=0,o=this.from;const u=()=>{const c=this.curve(s,this.from,this.to-this.from,this.duration);if(s>this.duration){this.callback(this.to);return}s+=1/60,o=c,this.callback(o),this.runner=window.requestAnimationFrame(u)};u()}stop(){this.runner!==void 0&&window.cancelAnimationFrame(this.runner)}}const Z={class:"font-[Helvetica Neue]"},ee=V({__name:"DynamicNumber",props:{value:null,init:{type:Boolean},toFixed:{default:1},duration:{default:2}},setup(e){const t=e,s=x("0"),o=x(),u=(d,y)=>new X(d,y,t.duration,v=>{s.value=`${v>0?"+":"-"} ${Math.abs(v).toFixed(t.toFixed)}`},W.easeOut),c=()=>{var d;(d=o.value)==null||d.stop(),o.value=u(Number(s.value.replace(" ","")),t.value),o.value.start()};return t.init&&c(),J(()=>t.value,()=>{c()}),(d,y)=>(h(),_("div",Z,p(s.value),1))}}),I=e=>{var o;const t=l();if(e.isSame(t,"days"))return E("Today");const s=e.diff(t,"day");return s<=3&&s>=0?((o=Y.value)==null?void 0:o.id)==="zh"?`${e.format("DD")}\u65E5`:e.format("MM-DD"):e.isSame(t,"year")?e.format("MM-DD"):e.format("YYYY-MM-DD")},te={class:"w-full h-full p-2 flex flex-col overflow-hidden"},se={class:"flex flex-wrap"},oe={class:"flex justify-between"},ne={class:"text-white"},ie={key:0,class:"flex-1 overflow-y-auto"},ae=["onClick"],re={class:"ml-7 text-sm"},le={class:"h-24 px-4 mt-4"},ce={class:"end flex items-center text-sm"},ue={key:1,class:"flex justify-center items-center text-sm text-gray-600 pt-20"},de=V({__name:"HomeView",setup(e){const{list:t}=q(),s=B(()=>t.value.filter(n=>n.time>=l().startOf("day").unix()&&n.time<=l().endOf("day").unix())),o=B(()=>s.value.reduce((n,i)=>n+(i.type===z.Expenses?-1:1)*i.money,0)),{show:u}=L(),c=(n,i)=>{const a=t.value[i-1];if(!a)return I(l.unix(n.time));const r=l.unix(a.time),f=l.unix(n.time);if(!r.isSame(f,"days"))return I(f)},d=(n,i)=>{let a=0;const r=Math.min(t.value.length,n+i);for(let w=n;w<r;w+=1){const F=t.value[w],$=t.value[w-1];(!$||!l.unix($.time).isSame(l.unix(F.time),"days"))&&(a+=1)}const f=56,N=72,A=r-n;return f*a+N*A},y=n=>d(0,n),v=x(),M=()=>{var i;const n=t.value.findIndex(a=>l.unix(a.time).isSame(l(),"date"));(i=v.value)==null||i.scrollTo(y(n))},k=x(!1);K(()=>{setTimeout(()=>{k.value=!0},1e3)});const S=n=>{var i;(i=document.querySelector(`.divider-${n}`))==null||i.scrollIntoView({behavior:"smooth"})},H=x("");return(n,i)=>(h(),_("div",te,[m("div",se,[m("div",{class:"bg-stone-800 h-20 w-full rounded-lg m-1 sm:flex-1 p-2",onClick:M},[m("div",oe,[m("div",ne,p(n.$t("Today")),1),b(ee,{value:g(o),init:"",class:"text-white text-4xl font-bold"},null,8,["value"])])])]),g(t).length?(h(),_("div",ie,[b(G,{ref_key:"listView",ref:v,list:g(t),"get-range-height":d,"footer-height":400,"value-key":"id",class:"main-bill-list mx-1"},{default:C(({item:a,index:r})=>[m("div",null,[c(a,r)?(h(),_("div",{key:0,class:T(["divider flex justify-between items-center px-4 pt-6 pb-3 cursor-pointer",[`divider-${r}`,{animated:k.value}]]),onClick:f=>S(r)},[m("div",re,p(c(a,r)),1)],10,ae)):P("",!0),b(Q,{bill:a,class:T([`item-${r}`,{animated:k.value,"to-remove":H.value===a.id}]),onClick:f=>g(u)(a)},null,8,["bill","class","onClick"])])]),footer:C(()=>[m("div",le,[m("div",ce,p(n.$t("ended")),1)])]),_:1},8,["list"])])):(h(),_("div",ue,p(n.$t("nothing-here-add-one-bill")),1))]))}});const $e=R(de,[["__scopeId","data-v-e46a283f"]]);export{$e as default};
