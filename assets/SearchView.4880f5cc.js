import{m as E,q as V,t as C,y as P,v as e,z as k,P as J,Q as L,r as y,c as G,w as Q,J as Z,k as x,B as b,u as n,G as a,i as S,Z as Y,_ as z,o as A,I as K}from"./@vue.6b771be9.js";import{u as W}from"./vue-router.c17ffd82.js";import{_ as O,e as N,d as X,B as F,t as q,f as ee,u as te,a as le}from"./index.2678cc06.js";import{_ as H}from"./Select.vue_vue_type_style_index_0_lang.77867c36.js";import{_ as R}from"./DateTime.vue_vue_type_script_setup_true_lang.1bb77d31.js";import{d as j}from"./dayjs.73288a1b.js";import{u as T}from"./useLimitSelect.b6e917fd.js";import{_ as se,a as ie}from"./BillItem.vue_vue_type_script_setup_true_lang.1fff3285.js";import{o as ne}from"./lodash-es.48fd3169.js";import"./dexie.a92c4e2b.js";import"./uuid.fbc3d34b.js";import"./@vueuse.3609b986.js";import"./vue-i18n.a532ecf1.js";import"./@intlify.03657722.js";import"./complex.js.3b936b7b.js";const oe=l=>(J("data-v-914c42f6"),l=l(),L(),l),ae={class:"clearable flex items-center"},de=oe(()=>e("i",{class:"icon-close icon-xs opacity-30"},null,-1)),ue=[de],ce=E({__name:"Clearable",props:{visible:{type:Boolean}},emits:["clear"],setup(l){return(I,_)=>(V(),C("div",ae,[P(I.$slots,"default",{},void 0,!0),e("div",{class:k(["close buttoned rounded-full",{visible:l.visible}]),onClick:_[0]||(_[0]=c=>I.$emit("clear"))},ue,2)]))}});const D=O(ce,[["__scopeId","data-v-914c42f6"]]),re=l=>{var m,$,w,f,d,u;const I=y(l!=null&&l.start?j(l==null?void 0:l.start):j.unix(-1/0)),_=y(l!=null&&l.end?j(l==null?void 0:l.end):j.unix(1/0)),c=y((m=l==null?void 0:l.max)!=null?m:-1/0),B=y(($=l==null?void 0:l.min)!=null?$:1/0),g=y(l==null?void 0:l.type),{allUsers:p}=X(),r=y((f=(w=l==null?void 0:l.users)==null?void 0:w.map(s=>p.value.find(t=>t.id===s)).filter(Boolean))!=null?f:[]);T(r,p);const o=y((u=(d=l==null?void 0:l.categories)==null?void 0:d.map(s=>N.find(t=>t.id===s)))!=null?u:[]),v=G(()=>N.filter(s=>g.value===void 0||s.type===g.value));return T(o,v),Q(g,()=>{o.value=[...v.value]}),{start:I,end:_,min:c,max:B,type:g,selectedUsers:r,selectedCategories:o,allUsers:p,billCategories:v,reset:()=>{I.value=j.unix(-1/0),_.value=j.unix(1/0),c.value=-1/0,B.value=1/0,g.value=void 0,r.value=p.value,o.value=[...v.value]}}},U=l=>(J("data-v-0d46fd9e"),l=l(),L(),l),ve={class:"pt-4 pb-2"},fe={class:"flex justify-between py-2"},me={class:"flex-1 flex justify-between"},_e={class:"flex"},xe={class:"flex justify-between py-2"},ye={class:"flex items-center px-2"},pe=U(()=>e("div",{class:"w-6 flex justify-center"},[e("i",{class:"icon-align-middle icon-xs"})],-1)),he={class:"px-2"},$e={class:"flex rounded-full shadow overflow-hidden"},we={class:"flex justify-between py-2"},be={class:"flex items-center px-2"},ge=U(()=>e("div",{class:"w-6 flex justify-center"},[e("i",{class:"icon-credit-card icon-xs"})],-1)),Ve={class:"px-2 whitespace-nowrap"},Ce={class:"flex"},Ie={class:"rounded-full shadow px-2 buttoned mx-2 flex items-center"},ke=U(()=>e("div",{class:"px-2"},"-",-1)),je={class:"rounded-full shadow px-2 buttoned mx-2"},Be={class:"flex justify-between py-2"},Se={class:"flex items-center px-2"},Ue=U(()=>e("div",{class:"w-6 flex justify-center"},[e("i",{class:"icon-user-list icon-xs"})],-1)),Me={class:"px-2"},De={class:"flex"},Fe={class:"shadow buttoned px-4 max-w-[160px] rounded-full h-full truncate mx-2 py-1"},Ye={class:"flex justify-between py-2"},ze={class:"flex items-center px-2"},Ee=U(()=>e("div",{class:"w-6 flex justify-center"},[e("i",{class:"icon-carousel icon-xs"})],-1)),Ne={class:"px-2"},qe={class:"flex"},He={class:"shadow buttoned px-4 max-w-[160px] rounded-full h-full truncate mx-2 py-1"},Re={class:"w-8 flex justify-center"},Te={class:"mx-2"},Je=U(()=>e("div",null,[e("i",{class:"icon-play-list-search"})],-1)),Le={class:"px-2"},Ge=E({__name:"BillFilter",props:{modelValue:null},emits:["update:modelValue"],setup(l,{emit:I}){const c=y(Boolean(l.modelValue)),B=()=>{c.value=!c.value},g=s=>s.isValid()?s.format("YYYY-MM-DD"):q("early"),p=s=>s.isValid()?s.format("YYYY-MM-DD"):q("later"),{start:r,end:o,min:v,max:h,type:m,selectedUsers:$,selectedCategories:w,allUsers:f,billCategories:d,reset:u}=re();return Z(()=>{var s,t;I("update:modelValue",{start:(s=r.value)!=null&&s.isValid()?r.value:void 0,end:(t=o.value)!=null&&t.isValid()?o.value:void 0,max:h.value,min:v.value,type:m.value,users:$.value.map(i=>i.id),categories:w.value.map(i=>i.id)})}),(s,t)=>(V(),C("div",ve,[e("div",{class:k(["filter-field transition-all rounded",[c.value?"h-[252px] opacity-100":"h-0 overflow-hidden opacity-0"]])},[e("div",fe,[e("div",me,[e("div",_e,[x(D,{visible:!0,class:"rounded-full shadow px-2 buttoned truncate py-2",onClear:t[1]||(t[1]=i=>r.value=n(j).unix(-1/0))},{default:b(()=>[x(R,{modelValue:n(r),"onUpdate:modelValue":t[0]||(t[0]=i=>S(r)?r.value=i:null),"display-formatter":g},{icon:b(()=>[e("div",null,a(s.$t("from"))+":",1)]),_:1},8,["modelValue"])]),_:1})]),e("div",null,[x(D,{visible:!0,class:"rounded-full shadow px-2 buttoned truncate py-2",onClear:t[3]||(t[3]=i=>o.value=n(j).unix(1/0))},{default:b(()=>[x(R,{modelValue:n(o),"onUpdate:modelValue":t[2]||(t[2]=i=>S(o)?o.value=i:null),"display-formatter":p},{icon:b(()=>[e("div",null,a(s.$t("to"))+":",1)]),_:1},8,["modelValue"])]),_:1})])])]),e("div",xe,[e("div",ye,[pe,e("div",he,a(s.$t("type"))+":",1)]),e("div",$e,[e("div",{class:k(["w-80px text-center buttoned py-1",{"!bg-stone-700 !text-white":n(m)===n(F).Income}]),onClick:t[4]||(t[4]=i=>m.value=n(F).Income)},a(s.$t("income")),3),e("div",{class:k(["w-80px text-center buttoned py-1",{"!bg-stone-700 !text-white":n(m)===n(F).Expenses}]),onClick:t[5]||(t[5]=i=>m.value=n(F).Expenses)},a(s.$t("expenses")),3),e("div",{class:k(["w-80px text-center buttoned py-1",{"!bg-stone-700 !text-white":n(m)===void 0}]),onClick:t[6]||(t[6]=i=>m.value=void 0)},a(s.$t("all")),3)])]),e("div",we,[e("div",be,[ge,e("div",Ve,a(s.$t("range"))+":",1)]),e("div",Ce,[e("div",Ie,[x(D,{visible:!0,onClear:t[9]||(t[9]=i=>v.value=-1/0)},{default:b(()=>[n(v)!==-1/0?Y((V(),C("input",{key:0,"onUpdate:modelValue":t[7]||(t[7]=i=>S(v)?v.value=i:null),type:"number",class:"max-w-50px bg-transparent focus:border-none focus:outline-none text-right py-1",inputmode:"decimal"},null,512)),[[z,n(v)]]):(V(),C("div",{key:1,class:"py-1",onClick:t[8]||(t[8]=i=>v.value=0)},a(s.$t("unlimited")),1))]),_:1})]),ke,e("div",je,[x(D,{visible:!0,onClear:t[12]||(t[12]=i=>h.value=1/0)},{default:b(()=>[n(h)!==1/0?Y((V(),C("input",{key:0,"onUpdate:modelValue":t[10]||(t[10]=i=>S(h)?h.value=i:null),type:"number",class:"max-w-50px bg-transparent focus:border-none focus:outline-none text-right py-1",inputmode:"decimal"},null,512)),[[z,n(h)]]):(V(),C("div",{key:1,class:"py-1",onClick:t[11]||(t[11]=i=>h.value=0)},a(s.$t("unlimited")),1))]),_:1})])])]),e("div",Be,[e("div",Se,[Ue,e("div",Me,a(s.$t("users"))+":",1)]),e("div",De,[x(H,{modelValue:n($),"onUpdate:modelValue":t[13]||(t[13]=i=>S($)?$.value=i:null),list:n(f),multiple:"","value-key":"id"},{default:b(({allSelected:i})=>[e("div",Fe,a(i?s.$t("all"):n($).length===0?"None":n($).map(M=>M.name).join(",")),1)]),_:1},8,["modelValue","list"])])]),e("div",Ye,[e("div",ze,[Ee,e("div",Ne,a(s.$t("categories"))+":",1)]),e("div",qe,[x(H,{modelValue:n(w),"onUpdate:modelValue":t[14]||(t[14]=i=>S(w)?w.value=i:null),list:n(d),multiple:"","value-key":"id"},{default:b(({allSelected:i})=>[e("div",He,a(i?s.$t("all"):n(w).length===0?s.$t("none"):n(w).map(M=>s.$t(M.name)).join(",")),1)]),option:b(({item:i,selected:M,select:at})=>[e("div",{class:k(["p-2 buttoned flex items-center",{"!bg-gray-700 text-white":M}])},[e("div",Re,[e("i",{class:k([i.icon])},null,2)]),e("div",Te,a(s.$t(i.name)),1)],2)]),_:1},8,["modelValue","list"])])])],2),e("div",{class:k(["flex justify-between py-2",{"border-t":c.value}])},[e("div",null,[e("div",{class:k(["buttoned rounded-sm px-2 text-gray-600",{"opacity-0 pointer-events-none":!c.value}]),onClick:t[15]||(t[15]=(...i)=>n(u)&&n(u)(...i))},a(s.$t("reset")),3)]),e("div",{class:"flex items-center rounded-sm buttoned px-2",onClick:B},[Je,e("div",Le,a(s.$t("filter")),1)])],2)]))}});const Oe=O(Ge,[["__scopeId","data-v-0d46fd9e"]]),Pe={class:"w-full h-full flex justify-center p-2"},Qe={class:"h-full w-full mx-2 max-w-[600px] flex flex-col"},Ze={class:"search w-full flex justify-center pt-4"},Ae={class:"w-full h-10 shadow-md rounded-sm flex items-center px-4 focus-within:shadow-lg"},Ke={class:"flex-1"},We=e("i",{class:"icon-search"},null,-1),Xe=[We],et={class:"flex-1 flex flex-col overflow-hidden"},tt={class:"flex items-center justify-between px-2"},lt={class:"text-sm text-gray-500"},st={key:0,class:"icon-sort-az opacity-40"},it={key:1,class:"icon-sort-za"},nt={key:2,class:"icon-sort-az"},ot={class:"flex-1 divide-y overflow-y-auto"},gt=E({__name:"SearchView",setup(l){const{list:I}=te(),_=y(""),c=y([]),B=W(),g=B.query.filters?JSON.parse(B.query.filters):void 0,p=y(g),r=[void 0,"asc","desc"],o=y(),v=()=>{const f=r.findIndex(u=>u===o.value),d=f+1>=r.length?0:f+1;o.value=r[d]},h=G(()=>o.value===void 0?c.value:ne(c.value,["money"],[o.value])),m=()=>{if(!p.value){c.value=[];return}const f=p.value;c.value=I.value.filter(d=>ee(d,{...f,comment:_.value}))};A(()=>{g&&m()});const $=(f,d)=>{const t=Math.min(c.value.length,f+d)-f;return 72*t},{show:w}=le();return(f,d)=>(V(),C("div",Pe,[e("div",Qe,[e("div",Ze,[e("div",Ae,[e("div",Ke,[x(D,{visible:_.value.length>0,onClear:d[1]||(d[1]=u=>_.value="")},{default:b(()=>[Y(e("input",{"onUpdate:modelValue":d[0]||(d[0]=u=>_.value=u),type:"text",class:"w-full bg-transparent focus:border-none focus:outline-none"},null,512),[[z,_.value]])]),_:1},8,["visible"])]),e("div",{class:"buttoned p-3 rounded-full",onClick:m},Xe)])]),e("div",et,[x(Oe,{modelValue:p.value,"onUpdate:modelValue":d[2]||(d[2]=u=>p.value=u)},null,8,["modelValue"]),e("div",tt,[e("div",lt,a(f.$t("total"))+": "+a(n(h).length),1),e("div",{onClick:v,class:"px-4 py-2 buttoned rounded-full"},[o.value===void 0?(V(),C("div",st)):o.value==="asc"?(V(),C("div",it)):o.value==="desc"?(V(),C("div",nt)):K("",!0)])]),e("div",ot,[x(se,{list:n(h),"value-key":"id","get-range-height":$,"footer-height":96},{default:b(({item:u})=>[x(ie,{bill:u,onClick:s=>n(w)(u)},null,8,["bill","onClick"])]),_:1},8,["list"])])])])]))}});export{gt as default};
