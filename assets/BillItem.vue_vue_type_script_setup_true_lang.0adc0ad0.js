import{t as L}from"./lodash-es.4471eccc.js";import{m as N,r as b,J as R,c as w,S as P,o as z,U as C,w as M,q as _,t as I,F as S,E as D,y as $,M as U,N as V,u as i,V as j,v as a,G as g,W as A,z as B,I as F}from"./@vue.e6301bd2.js";import{g as q,b as G,B as k}from"./index.83597891.js";const re=N({__name:"List",props:{list:null,valueKey:null,loading:{type:Boolean},getRangeHeight:null,remain:{default:20},footerHeight:{default:0},transitionName:null,transitionDuration:null},emits:["reachEnd"],setup(c,{expose:h}){const n=c,y=(e,t)=>n.valueKey===void 0?t:typeof n.valueKey=="function"?n.valueKey(e,t):e[n.valueKey],f=()=>{const e=[];return Array.from({length:Math.ceil(n.list.length/n.remain)},()=>0).forEach((t,l)=>{e.push([(l+1)*n.remain,n.getRangeHeight(l*n.remain+0,n.remain)])}),e},u=b([]);R(()=>{u.value=f()});const x=e=>u.value.findIndex((l,s)=>{const o=(()=>s===0?0:u.value.slice(0,s).reduce((p,K)=>p+K[1],0))();return o<e&&o+l[1]>=e}),d=b(-1),m=w(()=>{const e=u.value.reduce((o,p)=>o+p[1],0)+n.footerHeight;if(d.value<2)return{startIndex:0,list:n.list.slice(0,n.remain*3),style:`padding-top:${0}px; height:${e}px`};const t=u.value[d.value-2][0],l=Math.min(n.list.length,t+n.remain*3),s=u.value.slice(0,d.value-1).reduce((o,p)=>o+p[1],0);return{startIndex:t,list:n.list.slice(t,l),style:`padding-top:${s}px; height:${e}px`}}),v=e=>m.value.startIndex+e,r=b();let T=0;const E=L(e=>{const t=e.target;if(!t||!r.value)return;const l=r.value.offsetTop-t.offsetTop,s=t.scrollTop-l;d.value=x(s),T=t.scrollTop},50);P(()=>{var e,t,l;(t=(e=r.value)==null?void 0:e.parentElement)==null||t.addEventListener("scroll",E),(l=r.value)!=null&&l.parentElement&&(r.value.parentElement.scrollTop=T),A(()=>{var s,o;(o=(s=r.value)==null?void 0:s.parentElement)==null||o.removeEventListener("scroll",E)})}),z(()=>{var e,t,l;(t=(e=r.value)==null?void 0:e.parentElement)==null||t.addEventListener("scroll",E),(l=r.value)!=null&&l.parentElement&&(r.value.parentElement.scrollTop=T),C(()=>{var s,o;(o=(s=r.value)==null?void 0:s.parentElement)==null||o.removeEventListener("scroll",E)})});const H=b();return M(()=>n.list.length,()=>{H.value=n.transitionName}),h({scrollTo:e=>{var t,l;(l=(t=r.value)==null?void 0:t.parentElement)==null||l.scrollTo({top:e,behavior:"smooth"})}}),(e,t)=>(_(),I("div",{style:j(i(m).style),class:"list-view overflow-hidden",ref_key:"listEl",ref:r},[(_(!0),I(S,null,D(i(m).list,(l,s)=>$(e.$slots,"default",U(V({key:y(l,v(s))},{item:l,index:v(s)})),()=>[a("div",null,g(l),1)])),128)),$(e.$slots,"footer")],4))}}),J={class:"bill-item flex justify-between items-center px-4 py-4 buttoned cursor-pointer"},W={class:"flex items-center overflow-hidden"},O={class:"rounded-full bg-white border w-10 h-10 flex items-center justify-center"},Q={class:"flex-1 flex flex-col px-4 overflow-hidden"},X={class:"flex text-md font-semibold"},Y={class:"flex text-xs"},Z=a("div",{class:"px-1"},"|",-1),ee={class:"truncate"},oe=N({__name:"BillItem",props:{bill:null},setup(c){const h=c,n=w(()=>q(h.bill.categoryId)),y=w(()=>G(h.bill.creatorId));return(f,u)=>{var x,d,m,v;return _(),I("div",J,[a("div",W,[a("div",O,[a("i",{class:B([(x=i(n))==null?void 0:x.icon])},null,2)]),a("div",Q,[a("div",X,[a("div",null,g(i(n)?f.$t(i(n).name):""),1)]),a("div",Y,[a("div",null,g((d=i(y))!=null&&d.me?f.$t("me"):(v=(m=i(y))==null?void 0:m.name)!=null?v:f.$t("unknown-user")),1),c.bill.comment?(_(),I(S,{key:0},[Z,a("div",ee,g(c.bill.comment),1)],64)):F("",!0)])])]),a("div",{class:B(["text-lg font-bold truncate flex-shrink-0 text-right",{"text-red-700":c.bill.type===i(k).Expenses,"text-green-900":c.bill.type===i(k).Income}])},g(c.bill.money),3)])}}});export{re as _,oe as a};
