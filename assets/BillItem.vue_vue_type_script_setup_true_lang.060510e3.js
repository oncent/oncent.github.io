import{t as H}from"./lodash-es.94cbcf30.js";import{m as R,r as b,J as K,c as I,o as S,R as P,q as y,t as x,F as T,E as z,y as $,M as C,N as L,u as a,S as M,v as r,G as v,z as B,I as N}from"./@vue.aa17ec7c.js";import{g as j,b as F,B as w}from"./index.913fa80a.js";const X=R({__name:"List",props:{list:null,valueKey:null,loading:{type:Boolean},getRangeHeight:null,remain:{default:20},footerHeight:{default:0}},emits:["reachEnd"],setup(i){const t=i,m=(e,n)=>t.valueKey===void 0?n:typeof t.valueKey=="function"?t.valueKey(e,n):e[t.valueKey],h=()=>{const e=[];return Array.from({length:Math.ceil(t.list.length/t.remain)},()=>0).forEach((n,s)=>{e.push([(s+1)*t.remain,t.getRangeHeight(s*t.remain+0,t.remain)])}),e},o=b([]);K(()=>{o.value=h()});const _=e=>o.value.findIndex((s,l)=>{const f=(()=>l===0?0:o.value.slice(0,l).reduce((p,k)=>p+k[1],0))();return f<e&&f+s[1]>=e}),u=b(-1),d=I(()=>{const e=o.value.reduce((f,p)=>f+p[1],0)+t.footerHeight;if(u.value<2)return{startIndex:0,list:t.list.slice(0,t.remain*3),style:`padding-top:${0}px; height:${e}px`};const n=o.value[u.value-2][0],s=Math.min(t.list.length,n+t.remain*3),l=o.value.slice(0,u.value-1).reduce((f,p)=>f+p[1],0);return{startIndex:n,list:t.list.slice(n,s),style:`padding-top:${l}px; height:${e}px`}}),g=e=>d.value.startIndex+e,c=b(),E=H(e=>{const n=e.target;if(!n||!c.value)return;const s=c.value.offsetTop-n.offsetTop,l=n.scrollTop-s;u.value=_(l)},50);return S(()=>{var e,n;(n=(e=c.value)==null?void 0:e.parentElement)==null||n.addEventListener("scroll",E),P(()=>{var s,l;(l=(s=c.value)==null?void 0:s.parentElement)==null||l.removeEventListener("scroll",E)})}),(e,n)=>(y(),x("div",{style:M(a(d).style),class:"list-view overflow-hidden",ref_key:"listEl",ref:c},[(y(!0),x(T,null,z(a(d).list,(s,l)=>$(e.$slots,"default",C(L({key:m(s,g(l))},{item:s,index:g(l)})),()=>[r("div",null,v(s),1)])),128)),$(e.$slots,"footer")],4))}}),U={class:"bill-item flex justify-between items-center px-4 py-4 buttoned cursor-pointer"},V={class:"flex items-center"},q={class:"rounded-full bg-white border w-10 h-10 flex items-center justify-center"},A={class:"flex flex-col px-4"},D={class:"flex text-md font-semibold"},G={class:"flex text-xs"},J=r("div",{class:"px-1"},"|",-1),Y=R({__name:"BillItem",props:{bill:null},setup(i){const t=i,m=I(()=>j(t.bill.categoryId)),h=I(()=>F(t.bill.creatorId));return(o,_)=>{var u,d,g,c;return y(),x("div",U,[r("div",V,[r("div",q,[r("i",{class:B([(u=a(m))==null?void 0:u.icon])},null,2)]),r("div",A,[r("div",D,[r("div",null,v(a(m)?o.$t(a(m).name):""),1)]),r("div",G,[r("div",null,v((d=a(h))!=null&&d.me?o.$t("me"):(c=(g=a(h))==null?void 0:g.name)!=null?c:o.$t("unknown-user")),1),i.bill.comment?(y(),x(T,{key:0},[J,r("div",null,v(i.bill.comment),1)],64)):N("",!0)])])]),r("div",{class:B(["text-lg font-bold",{"text-red-700":i.bill.type===a(w).Expenses,"text-green-900":i.bill.type===a(w).Income}])},v(i.bill.money),3)])}}});export{X as _,Y as a};
