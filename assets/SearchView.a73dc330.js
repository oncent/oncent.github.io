import{m as E,q as V,t as C,y as P,v as e,z as k,P as J,Q as L,r as y,c as G,w as Q,J as Z,k as x,B as w,u as n,G as a,i as S,Z as Y,_ as z,o as A,I as K}from"./@vue.6b771be9.js";import{u as W}from"./vue-router.c17ffd82.js";import{_ as O,e as N,d as X,B as F,t as q,f as ee,u as te,a as le}from"./index.9baf700f.js";import{_ as H}from"./Select.vue_vue_type_style_index_0_lang.85fcceb7.js";import{_ as R}from"./DateTime.vue_vue_type_script_setup_true_lang.44300d6f.js";import{d as j}from"./dayjs.386643b6.js";import{u as T}from"./useLimitSelect.b6e917fd.js";import{_ as se,a as ie}from"./BillItem.vue_vue_type_script_setup_true_lang.215712fc.js";import{o as ne}from"./lodash-es.4471eccc.js";import"./dexie.a92c4e2b.js";import"./uuid.fbc3d34b.js";import"./@vueuse.3609b986.js";import"./vue-i18n.a532ecf1.js";import"./@intlify.03657722.js";import"./complex.js.3b936b7b.js";const oe=l=>(J("data-v-914c42f6"),l=l(),L(),l),ae={class:"clearable flex items-center"},de=oe(()=>e("i",{class:"icon-close icon-xs opacity-30"},null,-1)),ue=[de],ce=E({__name:"Clearable",props:{visible:{type:Boolean}},emits:["clear"],setup(l){return(I,r)=>(V(),C("div",ae,[P(I.$slots,"default",{},void 0,!0),e("div",{class:k(["close buttoned rounded-full",{visible:l.visible}]),onClick:r[0]||(r[0]=c=>I.$emit("clear"))},ue,2)]))}});const D=O(ce,[["__scopeId","data-v-914c42f6"]]),re=l=>{var _,b,$,m,d,u;const I=y(l!=null&&l.start?j(l==null?void 0:l.start):j.unix(-1/0)),r=y(l!=null&&l.end?j(l==null?void 0:l.end):j.unix(1/0)),c=y((_=l==null?void 0:l.max)!=null?_:-1/0),B=y((b=l==null?void 0:l.min)!=null?b:1/0),g=y(l==null?void 0:l.type),{allUsers:h}=X(),v=y((m=($=l==null?void 0:l.users)==null?void 0:$.map(s=>h.value.find(t=>t.id===s)).filter(Boolean))!=null?m:[]);T(v,h);const o=y((u=(d=l==null?void 0:l.categories)==null?void 0:d.map(s=>N.find(t=>t.id===s)))!=null?u:[]),f=G(()=>N.filter(s=>g.value===void 0||s.type===g.value));return T(o,f),Q(g,()=>{o.value=[...f.value]}),{start:I,end:r,min:c,max:B,type:g,selectedUsers:v,selectedCategories:o,allUsers:h,billCategories:f,reset:()=>{I.value=j.unix(-1/0),r.value=j.unix(1/0),c.value=-1/0,B.value=1/0,g.value=void 0,v.value=h.value,o.value=[...f.value]}}},U=l=>(J("data-v-8e9f41cb"),l=l(),L(),l),ve={class:"pt-4 pb-2"},fe={class:"flex justify-between py-2"},me={class:"flex-1 flex justify-between"},_e={class:"flex"},xe={class:"flex justify-between py-2"},ye={class:"flex items-center px-2"},he=U(()=>e("div",{class:"w-6 flex justify-center"},[e("i",{class:"icon-align-middle icon-xs"})],-1)),pe={class:"px-2"},be={class:"flex rounded-full shadow overflow-hidden"},$e={class:"flex justify-between py-2"},we={class:"flex items-center px-2"},ge=U(()=>e("div",{class:"w-6 flex justify-center"},[e("i",{class:"icon-credit-card icon-xs"})],-1)),Ve={class:"px-2 whitespace-nowrap"},Ce={class:"flex"},Ie={class:"rounded-full shadow px-2 buttoned mx-2 flex items-center"},ke=U(()=>e("div",{class:"px-2"},"-",-1)),je={class:"rounded-full shadow px-2 buttoned mx-2"},Be={class:"flex justify-between py-2"},Se={class:"flex items-center px-2"},Ue=U(()=>e("div",{class:"w-6 flex justify-center"},[e("i",{class:"icon-user-list icon-xs"})],-1)),Me={class:"px-2"},De={class:"flex"},Fe={class:"shadow buttoned px-4 max-w-[160px] rounded-full h-full truncate mx-2 py-1"},Ye={class:"flex justify-between py-2"},ze={class:"flex items-center px-2"},Ee=U(()=>e("div",{class:"w-6 flex justify-center"},[e("i",{class:"icon-carousel icon-xs"})],-1)),Ne={class:"px-2"},qe={class:"flex"},He={class:"shadow buttoned px-4 max-w-[160px] rounded-full h-full truncate mx-2 py-1"},Re={class:"w-8 flex justify-center"},Te={class:"mx-2"},Je=U(()=>e("div",null,[e("i",{class:"icon-play-list-search"})],-1)),Le={class:"px-2"},Ge=E({__name:"BillFilter",props:{modelValue:null},emits:["update:modelValue"],setup(l,{emit:I}){const r=l,c=y(Boolean(r.modelValue)),B=()=>{c.value=!c.value},g=s=>s.isValid()?s.format("YYYY-MM-DD"):q("early"),h=s=>s.isValid()?s.format("YYYY-MM-DD"):q("later"),{start:v,end:o,min:f,max:p,type:_,selectedUsers:b,selectedCategories:$,allUsers:m,billCategories:d,reset:u}=re(r.modelValue);return Z(()=>{var s,t;I("update:modelValue",{start:(s=v.value)!=null&&s.isValid()?v.value:void 0,end:(t=o.value)!=null&&t.isValid()?o.value:void 0,max:p.value,min:f.value,type:_.value,users:b.value.map(i=>i.id),categories:$.value.map(i=>i.id)})}),(s,t)=>(V(),C("div",ve,[e("div",{class:k(["filter-field transition-all rounded",[c.value?"h-[252px] opacity-100":"h-0 overflow-hidden opacity-0"]])},[e("div",fe,[e("div",me,[e("div",_e,[x(D,{visible:!0,class:"rounded-full shadow px-2 buttoned truncate py-2",onClear:t[1]||(t[1]=i=>v.value=n(j).unix(-1/0))},{default:w(()=>[x(R,{modelValue:n(v),"onUpdate:modelValue":t[0]||(t[0]=i=>S(v)?v.value=i:null),"display-formatter":g},{icon:w(()=>[e("div",null,a(s.$t("from"))+":",1)]),_:1},8,["modelValue"])]),_:1})]),e("div",null,[x(D,{visible:!0,class:"rounded-full shadow px-2 buttoned truncate py-2",onClear:t[3]||(t[3]=i=>o.value=n(j).unix(1/0))},{default:w(()=>[x(R,{modelValue:n(o),"onUpdate:modelValue":t[2]||(t[2]=i=>S(o)?o.value=i:null),"display-formatter":h},{icon:w(()=>[e("div",null,a(s.$t("to"))+":",1)]),_:1},8,["modelValue"])]),_:1})])])]),e("div",xe,[e("div",ye,[he,e("div",pe,a(s.$t("type"))+":",1)]),e("div",be,[e("div",{class:k(["w-80px text-center buttoned py-1",{"!bg-stone-700 !text-white":n(_)===n(F).Income}]),onClick:t[4]||(t[4]=i=>_.value=n(F).Income)},a(s.$t("income")),3),e("div",{class:k(["w-80px text-center buttoned py-1",{"!bg-stone-700 !text-white":n(_)===n(F).Expenses}]),onClick:t[5]||(t[5]=i=>_.value=n(F).Expenses)},a(s.$t("expenses")),3),e("div",{class:k(["w-80px text-center buttoned py-1",{"!bg-stone-700 !text-white":n(_)===void 0}]),onClick:t[6]||(t[6]=i=>_.value=void 0)},a(s.$t("all")),3)])]),e("div",$e,[e("div",we,[ge,e("div",Ve,a(s.$t("range"))+":",1)]),e("div",Ce,[e("div",Ie,[x(D,{visible:!0,onClear:t[9]||(t[9]=i=>f.value=-1/0)},{default:w(()=>[n(f)!==-1/0?Y((V(),C("input",{key:0,"onUpdate:modelValue":t[7]||(t[7]=i=>S(f)?f.value=i:null),type:"number",class:"max-w-50px bg-transparent focus:border-none focus:outline-none text-right py-1",inputmode:"decimal"},null,512)),[[z,n(f)]]):(V(),C("div",{key:1,class:"py-1",onClick:t[8]||(t[8]=i=>f.value=0)},a(s.$t("unlimited")),1))]),_:1})]),ke,e("div",je,[x(D,{visible:!0,onClear:t[12]||(t[12]=i=>p.value=1/0)},{default:w(()=>[n(p)!==1/0?Y((V(),C("input",{key:0,"onUpdate:modelValue":t[10]||(t[10]=i=>S(p)?p.value=i:null),type:"number",class:"max-w-50px bg-transparent focus:border-none focus:outline-none text-right py-1",inputmode:"decimal"},null,512)),[[z,n(p)]]):(V(),C("div",{key:1,class:"py-1",onClick:t[11]||(t[11]=i=>p.value=0)},a(s.$t("unlimited")),1))]),_:1})])])]),e("div",Be,[e("div",Se,[Ue,e("div",Me,a(s.$t("users"))+":",1)]),e("div",De,[x(H,{modelValue:n(b),"onUpdate:modelValue":t[13]||(t[13]=i=>S(b)?b.value=i:null),list:n(m),multiple:"","value-key":"id"},{default:w(({allSelected:i})=>[e("div",Fe,a(i?s.$t("all"):n(b).length===0?"None":n(b).map(M=>M.name).join(",")),1)]),_:1},8,["modelValue","list"])])]),e("div",Ye,[e("div",ze,[Ee,e("div",Ne,a(s.$t("categories"))+":",1)]),e("div",qe,[x(H,{modelValue:n($),"onUpdate:modelValue":t[14]||(t[14]=i=>S($)?$.value=i:null),list:n(d),multiple:"","value-key":"id"},{default:w(({allSelected:i})=>[e("div",He,a(i?s.$t("all"):n($).length===0?s.$t("none"):n($).map(M=>s.$t(M.name)).join(",")),1)]),option:w(({item:i,selected:M,select:at})=>[e("div",{class:k(["p-2 buttoned flex items-center",{"!bg-gray-700 text-white":M}])},[e("div",Re,[e("i",{class:k([i.icon])},null,2)]),e("div",Te,a(s.$t(i.name)),1)],2)]),_:1},8,["modelValue","list"])])])],2),e("div",{class:k(["flex justify-between py-2",{"border-t":c.value}])},[e("div",null,[e("div",{class:k(["buttoned rounded-sm px-2 text-gray-600",{"opacity-0 pointer-events-none":!c.value}]),onClick:t[15]||(t[15]=(...i)=>n(u)&&n(u)(...i))},a(s.$t("reset")),3)]),e("div",{class:"flex items-center rounded-sm buttoned px-2",onClick:B},[Je,e("div",Le,a(s.$t("filter")),1)])],2)]))}});const Oe=O(Ge,[["__scopeId","data-v-8e9f41cb"]]),Pe={class:"w-full h-full flex justify-center p-2"},Qe={class:"h-full w-full mx-2 max-w-[600px] flex flex-col"},Ze={class:"search w-full flex justify-center pt-4"},Ae={class:"w-full h-10 shadow-md rounded-sm flex items-center px-4 focus-within:shadow-lg"},Ke={class:"flex-1"},We=e("i",{class:"icon-search"},null,-1),Xe=[We],et={class:"flex-1 flex flex-col overflow-hidden"},tt={class:"flex items-center justify-between px-2"},lt={class:"text-sm text-gray-500"},st={key:0,class:"icon-sort-az opacity-40"},it={key:1,class:"icon-sort-za"},nt={key:2,class:"icon-sort-az"},ot={class:"flex-1 divide-y overflow-y-auto"},gt=E({__name:"SearchView",setup(l){const{list:I}=te(),r=y(""),c=y([]),B=W(),g=B.query.filters?JSON.parse(B.query.filters):void 0,h=y(g),v=[void 0,"asc","desc"],o=y(),f=()=>{const m=v.findIndex(u=>u===o.value),d=m+1>=v.length?0:m+1;o.value=v[d]},p=G(()=>o.value===void 0?c.value:ne(c.value,["money"],[o.value])),_=()=>{if(!h.value){c.value=[];return}const m=h.value;c.value=I.value.filter(d=>ee(d,{...m,comment:r.value}))};A(()=>{g&&_()});const b=(m,d)=>{const t=Math.min(c.value.length,m+d)-m;return 72*t},{show:$}=le();return(m,d)=>(V(),C("div",Pe,[e("div",Qe,[e("div",Ze,[e("div",Ae,[e("div",Ke,[x(D,{visible:r.value.length>0,onClear:d[1]||(d[1]=u=>r.value="")},{default:w(()=>[Y(e("input",{"onUpdate:modelValue":d[0]||(d[0]=u=>r.value=u),type:"text",class:"w-full bg-transparent focus:border-none focus:outline-none"},null,512),[[z,r.value]])]),_:1},8,["visible"])]),e("div",{class:"buttoned p-3 rounded-full",onClick:_},Xe)])]),e("div",et,[x(Oe,{modelValue:h.value,"onUpdate:modelValue":d[2]||(d[2]=u=>h.value=u)},null,8,["modelValue"]),e("div",tt,[e("div",lt,a(m.$t("total"))+": "+a(n(p).length),1),e("div",{onClick:f,class:"px-4 py-2 buttoned rounded-full"},[o.value===void 0?(V(),C("div",st)):o.value==="asc"?(V(),C("div",it)):o.value==="desc"?(V(),C("div",nt)):K("",!0)])]),e("div",ot,[x(se,{list:n(p),"value-key":"id","get-range-height":b,"footer-height":96},{default:w(({item:u})=>[x(ie,{bill:u,onClick:s=>n($)(u)},null,8,["bill","onClick"])]),_:1},8,["list"])])])])]))}});export{gt as default};
