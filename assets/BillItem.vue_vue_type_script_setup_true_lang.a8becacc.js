import{t as K}from"./lodash-es.94cbcf30.js";import{m as T,r as x,J as S,c as P,o as z,R as C,q as p,t as y,F as k,E as L,y as B,M,N,u as i,S as j,v as r,G as g,z as _,I as F}from"./@vue.aa17ec7c.js";import{g as $,b as w,B as R}from"./index.9689020f.js";const X=T({__name:"List",props:{list:null,valueKey:null,loading:{type:Boolean},getRangeHeight:null,remain:{default:20},footerHeight:{default:0}},emits:["reachEnd"],setup(a){const t=a,b=(e,n)=>t.valueKey===void 0?n:typeof t.valueKey=="function"?t.valueKey(e,n):e[t.valueKey],v=()=>{const e=[];return Array.from({length:Math.ceil(t.list.length/t.remain)},()=>0).forEach((n,l)=>{e.push([(l+1)*t.remain,t.getRangeHeight(l*t.remain+0,t.remain)])}),e},o=x([]);S(()=>{o.value=v()});const h=e=>o.value.findIndex((l,s)=>{const d=(()=>s===0?0:o.value.slice(0,s).reduce((m,H)=>m+H[1],0))();return d<e&&d+l[1]>=e}),c=x(-1),u=P(()=>{const e=o.value.reduce((d,m)=>d+m[1],0)+t.footerHeight;if(c.value<2)return{startIndex:0,list:t.list.slice(0,t.remain*3),style:`padding-top:${0}px; height:${e}px`};const n=o.value[c.value-2][0],l=Math.min(t.list.length,n+t.remain*3),s=o.value.slice(0,c.value-1).reduce((d,m)=>d+m[1],0);return{startIndex:n,list:t.list.slice(n,l),style:`padding-top:${s}px; height:${e}px`}}),I=e=>u.value.startIndex+e,f=x(),E=K(e=>{const n=e.target;if(!n||!f.value)return;const l=f.value.offsetTop-n.offsetTop,s=n.scrollTop-l;c.value=h(s)},50);return z(()=>{var e,n;(n=(e=f.value)==null?void 0:e.parentElement)==null||n.addEventListener("scroll",E),C(()=>{var l,s;(s=(l=f.value)==null?void 0:l.parentElement)==null||s.removeEventListener("scroll",E)})}),(e,n)=>(p(),y("div",{style:j(i(u).style),class:"list-view overflow-hidden",ref_key:"listEl",ref:f},[(p(!0),y(k,null,L(i(u).list,(l,s)=>B(e.$slots,"default",M(N({key:b(l,I(s))},{item:l,index:I(s)})),()=>[r("div",null,g(l),1)])),128)),B(e.$slots,"footer")],4))}}),U={class:"bill-item flex justify-between items-center px-4 py-4 buttoned cursor-pointer"},V={class:"flex items-center"},q={class:"rounded-full bg-white border w-10 h-10 flex items-center justify-center"},A={class:"flex flex-col px-4"},D={class:"flex text-md font-semibold"},G={class:"flex text-xs"},J=r("div",{class:"px-1"},"|",-1),Y=T({__name:"BillItem",props:{bill:null},setup(a){return(t,b)=>{var v,o,h,c,u;return p(),y("div",U,[r("div",V,[r("div",q,[r("i",{class:_([(v=i($)(a.bill.categoryId))==null?void 0:v.icon])},null,2)]),r("div",A,[r("div",D,[r("div",null,g((o=i($)(a.bill.categoryId))==null?void 0:o.name),1)]),r("div",G,[r("div",null,g((h=i(w)(a.bill.creatorId))!=null&&h.me?t.$t("me"):(u=(c=i(w)(a.bill.creatorId))==null?void 0:c.name)!=null?u:t.$t("unknown-user")),1),a.bill.comment?(p(),y(k,{key:0},[J,r("div",null,g(a.bill.comment),1)],64)):F("",!0)])])]),r("div",{class:_(["text-lg font-bold",{"text-red-700":a.bill.type===i(R).Expenses,"text-green-900":a.bill.type===i(R).Income}])},g(a.bill.money),3)])}}});export{X as _,Y as a};
