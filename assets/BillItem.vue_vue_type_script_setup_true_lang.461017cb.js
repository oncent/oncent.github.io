import{m as k,r as x,J as H,c as _,o as K,R as S,w as L,q as y,t as b,k as P,B as z,C as M,y as B,S as D,u as i,F as N,E as V,v as r,G as h,M as j,N as A,z as T,I as F}from"./@vue.aa17ec7c.js";import{t as G}from"./lodash-es.94cbcf30.js";import{g as U,b as q,B as $}from"./index.15024016.js";const le=k({__name:"List",props:{list:null,valueKey:null,loading:{type:Boolean},getRangeHeight:null,remain:{default:20},footerHeight:{default:0},transitionName:null,transitionDuration:null},emits:["reachEnd"],setup(o){const e=o,m=(t,n)=>e.valueKey===void 0?n:typeof e.valueKey=="function"?e.valueKey(t,n):t[e.valueKey],p=()=>{const t=[];return Array.from({length:Math.ceil(e.list.length/e.remain)},()=>0).forEach((n,s)=>{t.push([(s+1)*e.remain,e.getRangeHeight(s*e.remain+0,e.remain)])}),t},a=x([]);H(()=>{a.value=p()});const E=t=>a.value.findIndex((s,l)=>{const f=(()=>l===0?0:a.value.slice(0,l).reduce((g,C)=>g+C[1],0))();return f<t&&f+s[1]>=t}),u=x(-1),d=_(()=>{const t=a.value.reduce((f,g)=>f+g[1],0)+e.footerHeight;if(u.value<2)return{startIndex:0,list:e.list.slice(0,e.remain*3),style:`padding-top:${0}px; height:${t}px`};const n=a.value[u.value-2][0],s=Math.min(e.list.length,n+e.remain*3),l=a.value.slice(0,u.value-1).reduce((f,g)=>f+g[1],0);return{startIndex:n,list:e.list.slice(n,s),style:`padding-top:${l}px; height:${t}px`}}),v=t=>d.value.startIndex+t,c=x(),w=G(t=>{const n=t.target;if(!n||!c.value)return;const s=c.value.offsetTop-n.offsetTop,l=n.scrollTop-s;u.value=E(l)},50);K(()=>{var t,n;(n=(t=c.value)==null?void 0:t.parentElement)==null||n.addEventListener("scroll",w),S(()=>{var s,l;(l=(s=c.value)==null?void 0:s.parentElement)==null||l.removeEventListener("scroll",w)})});const I=x();L(()=>e.list.length,()=>{I.value=e.transitionName});const R=()=>{I.value=void 0};return(t,n)=>(y(),b("div",{style:D(i(d).style),class:"list-view overflow-hidden",ref_key:"listEl",ref:c},[P(M,{name:I.value,duration:o.transitionDuration,onAfterLeave:R},{default:z(()=>[(y(!0),b(N,null,V(i(d).list,(s,l)=>B(t.$slots,"default",j(A({key:m(s,v(l))},{item:s,index:v(l)})),()=>[r("div",null,h(s),1)])),128))]),_:3},8,["name","duration"]),B(t.$slots,"footer")],4))}}),J={class:"bill-item flex justify-between items-center px-4 py-4 buttoned cursor-pointer"},O={class:"flex items-center overflow-hidden"},Q={class:"rounded-full bg-white border w-10 h-10 flex items-center justify-center"},W={class:"flex-1 flex flex-col px-4 overflow-hidden"},X={class:"flex text-md font-semibold"},Y={class:"flex text-xs"},Z=r("div",{class:"px-1"},"|",-1),ee={class:"truncate"},re=k({__name:"BillItem",props:{bill:null},setup(o){const e=o,m=_(()=>U(e.bill.categoryId)),p=_(()=>q(e.bill.creatorId));return(a,E)=>{var u,d,v,c;return y(),b("div",J,[r("div",O,[r("div",Q,[r("i",{class:T([(u=i(m))==null?void 0:u.icon])},null,2)]),r("div",W,[r("div",X,[r("div",null,h(i(m)?a.$t(i(m).name):""),1)]),r("div",Y,[r("div",null,h((d=i(p))!=null&&d.me?a.$t("me"):(c=(v=i(p))==null?void 0:v.name)!=null?c:a.$t("unknown-user")),1),o.bill.comment?(y(),b(N,{key:0},[Z,r("div",ee,h(o.bill.comment),1)],64)):F("",!0)])])]),r("div",{class:T(["text-lg font-bold truncate flex-shrink-0 text-right",{"text-red-700":o.bill.type===i($).Expenses,"text-green-900":o.bill.type===i($).Income}])},h(o.bill.money),3)])}}});export{le as _,re as a};
