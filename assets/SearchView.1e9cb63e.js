import{m as H,q as h,t as $,y as ie,v as e,z as b,P as te,Q as se,r as f,c as le,w as E,J as ne,k as p,B as m,u as _,G as n,Z as N,_ as q,o as ae,I as de}from"./@vue.6b771be9.js";import{u as ue}from"./vue-router.c17ffd82.js";import{_ as oe,B as Y,d as re,e as ce,t as W,f as ve,u as fe,a as pe}from"./index.10cbdfce.js";import{_ as X}from"./Select.vue_vue_type_style_index_0_lang.1ef1b673.js";import{_ as ee}from"./DateTime.vue_vue_type_script_setup_true_lang.1bb77d31.js";import{d as V}from"./dayjs.73288a1b.js";import{_ as me,a as _e}from"./BillItem.vue_vue_type_script_setup_true_lang.c8d30cc0.js";import{o as xe}from"./lodash-es.48fd3169.js";import"./dexie.a92c4e2b.js";import"./uuid.fbc3d34b.js";import"./@vueuse.3609b986.js";import"./vue-i18n.a532ecf1.js";import"./@intlify.03657722.js";import"./complex.js.3b936b7b.js";const ye=c=>(te("data-v-914c42f6"),c=c(),se(),c),he={class:"clearable flex items-center"},$e=ye(()=>e("i",{class:"icon-close icon-xs opacity-30"},null,-1)),we=[$e],be=H({__name:"Clearable",props:{visible:{type:Boolean}},emits:["clear"],setup(c){return(C,i)=>(h(),$("div",he,[ie(C.$slots,"default",{},void 0,!0),e("div",{class:b(["close buttoned rounded-full",{visible:c.visible}]),onClick:i[0]||(i[0]=v=>C.$emit("clear"))},we,2)]))}});const U=oe(be,[["__scopeId","data-v-914c42f6"]]),j=c=>(te("data-v-d3495793"),c=c(),se(),c),ge={class:"pt-4 pb-2"},Ve={class:"flex justify-between py-2"},Ce={class:"flex-1 flex justify-between"},Ie={class:"flex"},ke={class:"flex justify-between py-2"},je={class:"flex items-center px-2"},Be=j(()=>e("div",{class:"w-6 flex justify-center"},[e("i",{class:"icon-align-middle icon-xs"})],-1)),Se={class:"px-2"},Ue={class:"flex rounded-full shadow overflow-hidden"},Me={class:"flex justify-between py-2"},De={class:"flex items-center px-2"},Ye=j(()=>e("div",{class:"w-6 flex justify-center"},[e("i",{class:"icon-credit-card icon-xs"})],-1)),Fe={class:"px-2 whitespace-nowrap"},ze={class:"flex"},Ee={class:"rounded-full shadow px-2 buttoned mx-2 flex items-center"},Ne=j(()=>e("div",{class:"px-2"},"-",-1)),qe={class:"rounded-full shadow px-2 buttoned mx-2"},He={class:"flex justify-between py-2"},Te={class:"flex items-center px-2"},Je=j(()=>e("div",{class:"w-6 flex justify-center"},[e("i",{class:"icon-user-list icon-xs"})],-1)),Le={class:"px-2"},Re={class:"flex"},Ge={class:"shadow buttoned px-4 max-w-[160px] rounded-full h-full truncate mx-2 py-1"},Oe={class:"flex justify-between py-2"},Pe={class:"flex items-center px-2"},Qe=j(()=>e("div",{class:"w-6 flex justify-center"},[e("i",{class:"icon-carousel icon-xs"})],-1)),Ze={class:"px-2"},Ae={class:"flex"},Ke={class:"shadow buttoned px-4 max-w-[160px] rounded-full h-full truncate mx-2 py-1"},We={class:"w-8 flex justify-center"},Xe={class:"mx-2"},et=j(()=>e("div",null,[e("i",{class:"icon-play-list-search"})],-1)),tt={class:"px-2"},st=H({__name:"BillFilter",props:{modelValue:null},emits:["update:modelValue"],setup(c,{emit:C}){var D,T,J,L,R,G,O,P,Q,Z,A,K;const i=c,v=f(Boolean(i.modelValue)),M=()=>{v.value=!v.value},B=(s,t)=>{s.value=t.value;const l=E(()=>t.value.length,w=>{w>0&&(s.value=t.value,l())});E(()=>s.value,(w,z)=>{w.length===0&&(z.length===1?s.value=[z[0]]:s.value=[t.value[0]])})},I=s=>s.isValid()?s.format("YYYY-MM-DD"):W("early"),S=s=>s.isValid()?s.format("YYYY-MM-DD"):W("later"),u=f((D=i.modelValue)!=null&&D.start?V((T=i.modelValue)==null?void 0:T.start):V.unix(-1/0)),g=f((J=i.modelValue)!=null&&J.end?V((L=i.modelValue)==null?void 0:L.end):V.unix(1/0)),x=f((G=(R=i.modelValue)==null?void 0:R.max)!=null?G:-1/0),y=f((P=(O=i.modelValue)==null?void 0:O.min)!=null?P:1/0),r=f((Q=i.modelValue)==null?void 0:Q.type),{allUsers:k}=re(),a=f((K=(A=(Z=i.modelValue)==null?void 0:Z.users)==null?void 0:A.map(s=>k.value.find(t=>t.id===s)).filter(Boolean))!=null?K:[]);B(a,k);const o=f([]),d=le(()=>ce.filter(s=>r.value===void 0||s.type===r.value));B(o,d),E(r,()=>{o.value=[...d.value]});const F=()=>{u.value=V.unix(-1/0),g.value=V.unix(1/0),x.value=-1/0,y.value=1/0,r.value=void 0,a.value=k.value,o.value=[...d.value]};return ne(()=>{var s,t;C("update:modelValue",{start:(s=u.value)!=null&&s.isValid()?u.value:void 0,end:(t=g.value)!=null&&t.isValid()?g.value:void 0,max:y.value,min:x.value,type:r.value,users:a.value.map(l=>l.id),categories:o.value.map(l=>l.id)})}),(s,t)=>(h(),$("div",ge,[e("div",{class:b(["filter-field transition-all rounded",[v.value?"h-[252px] opacity-100":"h-0 overflow-hidden opacity-0"]])},[e("div",Ve,[e("div",Ce,[e("div",Ie,[p(U,{visible:!0,class:"rounded-full shadow px-2 buttoned truncate py-2",onClear:t[1]||(t[1]=l=>u.value=_(V).unix(-1/0))},{default:m(()=>[p(ee,{modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=l=>u.value=l),"display-formatter":I},{icon:m(()=>[e("div",null,n(s.$t("from"))+":",1)]),_:1},8,["modelValue"])]),_:1})]),e("div",null,[p(U,{visible:!0,class:"rounded-full shadow px-2 buttoned truncate py-2",onClear:t[3]||(t[3]=l=>g.value=_(V).unix(1/0))},{default:m(()=>[p(ee,{modelValue:g.value,"onUpdate:modelValue":t[2]||(t[2]=l=>g.value=l),"display-formatter":S},{icon:m(()=>[e("div",null,n(s.$t("to"))+":",1)]),_:1},8,["modelValue"])]),_:1})])])]),e("div",ke,[e("div",je,[Be,e("div",Se,n(s.$t("type"))+":",1)]),e("div",Ue,[e("div",{class:b(["w-80px text-center buttoned py-1",{"!bg-stone-700 !text-white":r.value===_(Y).Income}]),onClick:t[4]||(t[4]=l=>r.value=_(Y).Income)},n(s.$t("income")),3),e("div",{class:b(["w-80px text-center buttoned py-1",{"!bg-stone-700 !text-white":r.value===_(Y).Expenses}]),onClick:t[5]||(t[5]=l=>r.value=_(Y).Expenses)},n(s.$t("expenses")),3),e("div",{class:b(["w-80px text-center buttoned py-1",{"!bg-stone-700 !text-white":r.value===void 0}]),onClick:t[6]||(t[6]=l=>r.value=void 0)},n(s.$t("all")),3)])]),e("div",Me,[e("div",De,[Ye,e("div",Fe,n(s.$t("range"))+":",1)]),e("div",ze,[e("div",Ee,[p(U,{visible:!0,onClear:t[9]||(t[9]=l=>x.value=-1/0)},{default:m(()=>[x.value!==-1/0?N((h(),$("input",{key:0,"onUpdate:modelValue":t[7]||(t[7]=l=>x.value=l),type:"number",class:"max-w-50px bg-transparent focus:border-none focus:outline-none text-right py-1",inputmode:"decimal"},null,512)),[[q,x.value]]):(h(),$("div",{key:1,class:"py-1",onClick:t[8]||(t[8]=l=>x.value=0)},n(s.$t("unlimited")),1))]),_:1})]),Ne,e("div",qe,[p(U,{visible:!0,onClear:t[12]||(t[12]=l=>y.value=1/0)},{default:m(()=>[y.value!==1/0?N((h(),$("input",{key:0,"onUpdate:modelValue":t[10]||(t[10]=l=>y.value=l),type:"number",class:"max-w-50px bg-transparent focus:border-none focus:outline-none text-right py-1",inputmode:"decimal"},null,512)),[[q,y.value]]):(h(),$("div",{key:1,class:"py-1",onClick:t[11]||(t[11]=l=>y.value=0)},n(s.$t("unlimited")),1))]),_:1})])])]),e("div",He,[e("div",Te,[Je,e("div",Le,n(s.$t("users"))+":",1)]),e("div",Re,[p(X,{modelValue:a.value,"onUpdate:modelValue":t[13]||(t[13]=l=>a.value=l),list:_(k),multiple:"","value-key":"id"},{default:m(({allSelected:l})=>[e("div",Ge,n(l?s.$t("all"):a.value.length===0?"None":a.value.map(w=>w.name).join(",")),1)]),_:1},8,["modelValue","list"])])]),e("div",Oe,[e("div",Pe,[Qe,e("div",Ze,n(s.$t("categories"))+":",1)]),e("div",Ae,[p(X,{modelValue:o.value,"onUpdate:modelValue":t[14]||(t[14]=l=>o.value=l),list:_(d),multiple:"","value-key":"id"},{default:m(({allSelected:l})=>[e("div",Ke,n(l?s.$t("all"):o.value.length===0?s.$t("none"):o.value.map(w=>s.$t(w.name)).join(",")),1)]),option:m(({item:l,selected:w,select:z})=>[e("div",{class:b(["p-2 buttoned flex items-center",{"!bg-gray-700 text-white":w}])},[e("div",We,[e("i",{class:b([l.icon])},null,2)]),e("div",Xe,n(s.$t(l.name)),1)],2)]),_:1},8,["modelValue","list"])])])],2),e("div",{class:b(["flex justify-between py-2",{"border-t":v.value}])},[e("div",null,[e("div",{class:b(["buttoned rounded-sm px-2 text-gray-600",{"opacity-0 pointer-events-none":!v.value}]),onClick:F},n(s.$t("reset")),3)]),e("div",{class:"flex items-center rounded-sm buttoned px-2",onClick:M},[et,e("div",tt,n(s.$t("filter")),1)])],2)]))}});const lt=oe(st,[["__scopeId","data-v-d3495793"]]),ot={class:"w-full h-full flex justify-center p-2"},it={class:"h-full w-full mx-2 max-w-[600px] flex flex-col"},nt={class:"search w-full flex justify-center pt-4"},at={class:"w-full h-10 shadow-md rounded-sm flex items-center px-4 focus-within:shadow-lg"},dt={class:"flex-1"},ut=e("i",{class:"icon-search"},null,-1),rt=[ut],ct={class:"flex-1 flex flex-col overflow-hidden"},vt={class:"flex items-center justify-between px-2"},ft={class:"text-sm text-gray-500"},pt={key:0,class:"icon-sort-az opacity-40"},mt={key:1,class:"icon-sort-az"},_t={key:2,class:"icon-sort-za"},xt={class:"flex-1 divide-y overflow-y-auto"},Mt=H({__name:"SearchView",setup(c){const{list:C}=fe(),i=f(""),v=f([]),M=ue(),B=M.query.filters?JSON.parse(M.query.filters):void 0,I=f(B),S=[void 0,"asc","desc"],u=f(),g=()=>{const a=S.findIndex(d=>d===u.value),o=a+1>=S.length?0:a+1;u.value=S[o]},x=le(()=>u.value===void 0?v.value:xe(v.value,["money"],[u.value])),y=()=>{if(!I.value){v.value=[];return}const a=I.value;v.value=C.value.filter(o=>ve(o,{...a,comment:i.value}))};ae(()=>{B&&y()});const r=(a,o)=>{const D=Math.min(v.value.length,a+o)-a;return 72*D},{show:k}=pe();return(a,o)=>(h(),$("div",ot,[e("div",it,[e("div",nt,[e("div",at,[e("div",dt,[p(U,{visible:i.value.length>0,onClear:o[1]||(o[1]=d=>i.value="")},{default:m(()=>[N(e("input",{"onUpdate:modelValue":o[0]||(o[0]=d=>i.value=d),type:"text",class:"w-full bg-transparent focus:border-none focus:outline-none"},null,512),[[q,i.value]])]),_:1},8,["visible"])]),e("div",{class:"buttoned p-3 rounded-full",onClick:y},rt)])]),e("div",ct,[p(lt,{modelValue:I.value,"onUpdate:modelValue":o[2]||(o[2]=d=>I.value=d)},null,8,["modelValue"]),e("div",vt,[e("div",ft,n(a.$t("total"))+": "+n(_(x).length),1),e("div",{onClick:g,class:"px-4 py-2 buttoned rounded-full"},[u.value===void 0?(h(),$("div",pt)):u.value==="asc"?(h(),$("div",mt)):u.value==="desc"?(h(),$("div",_t)):de("",!0)])]),e("div",xt,[p(me,{list:_(x),"value-key":"id","get-range-height":r,"footer-height":96},{default:m(({item:d})=>[p(_e,{bill:d,onClick:F=>_(k)(d)},null,8,["bill","onClick"])]),_:1},8,["list"])])])])]))}});export{Mt as default};
