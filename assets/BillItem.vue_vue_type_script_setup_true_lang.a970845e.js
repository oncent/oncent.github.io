import{t as H}from"./lodash-es.94cbcf30.js";import{m as T,r as y,J as K,c as _,o as S,R as P,w as z,q as x,t as b,F as k,E as C,y as w,M as L,N as M,u as a,S as j,v as r,G as h,z as $,I as D}from"./@vue.aa17ec7c.js";import{g as F,b as U,B}from"./index.1ab36cef.js";const ee=T({__name:"List",props:{list:null,valueKey:null,loading:{type:Boolean},getRangeHeight:null,remain:{default:20},footerHeight:{default:0},transitionName:null,transitionDuration:null},emits:["reachEnd"],setup(i){const e=i,m=(t,n)=>e.valueKey===void 0?n:typeof e.valueKey=="function"?e.valueKey(t,n):t[e.valueKey],p=()=>{const t=[];return Array.from({length:Math.ceil(e.list.length/e.remain)},()=>0).forEach((n,s)=>{t.push([(s+1)*e.remain,e.getRangeHeight(s*e.remain+0,e.remain)])}),t},o=y([]);K(()=>{o.value=p()});const I=t=>o.value.findIndex((s,l)=>{const f=(()=>l===0?0:o.value.slice(0,l).reduce((v,R)=>v+R[1],0))();return f<t&&f+s[1]>=t}),u=y(-1),d=_(()=>{const t=o.value.reduce((f,v)=>f+v[1],0)+e.footerHeight;if(u.value<2)return{startIndex:0,list:e.list.slice(0,e.remain*3),style:`padding-top:${0}px; height:${t}px`};const n=o.value[u.value-2][0],s=Math.min(e.list.length,n+e.remain*3),l=o.value.slice(0,u.value-1).reduce((f,v)=>f+v[1],0);return{startIndex:n,list:e.list.slice(n,s),style:`padding-top:${l}px; height:${t}px`}}),g=t=>d.value.startIndex+t,c=y(),E=H(t=>{const n=t.target;if(!n||!c.value)return;const s=c.value.offsetTop-n.offsetTop,l=n.scrollTop-s;u.value=I(l)},50);S(()=>{var t,n;(n=(t=c.value)==null?void 0:t.parentElement)==null||n.addEventListener("scroll",E),P(()=>{var s,l;(l=(s=c.value)==null?void 0:s.parentElement)==null||l.removeEventListener("scroll",E)})});const N=y();return z(()=>e.list.length,()=>{N.value=e.transitionName}),(t,n)=>(x(),b("div",{style:j(a(d).style),class:"list-view overflow-hidden",ref_key:"listEl",ref:c},[(x(!0),b(k,null,C(a(d).list,(s,l)=>w(t.$slots,"default",L(M({key:m(s,g(l))},{item:s,index:g(l)})),()=>[r("div",null,h(s),1)])),128)),w(t.$slots,"footer")],4))}}),V={class:"bill-item flex justify-between items-center px-4 py-4 buttoned cursor-pointer"},q={class:"flex items-center overflow-hidden"},A={class:"rounded-full bg-white border w-10 h-10 flex items-center justify-center"},G={class:"flex-1 flex flex-col px-4 overflow-hidden"},J={class:"flex text-md font-semibold"},O={class:"flex text-xs"},Q=r("div",{class:"px-1"},"|",-1),W={class:"truncate"},te=T({__name:"BillItem",props:{bill:null},setup(i){const e=i,m=_(()=>F(e.bill.categoryId)),p=_(()=>U(e.bill.creatorId));return(o,I)=>{var u,d,g,c;return x(),b("div",V,[r("div",q,[r("div",A,[r("i",{class:$([(u=a(m))==null?void 0:u.icon])},null,2)]),r("div",G,[r("div",J,[r("div",null,h(a(m)?o.$t(a(m).name):""),1)]),r("div",O,[r("div",null,h((d=a(p))!=null&&d.me?o.$t("me"):(c=(g=a(p))==null?void 0:g.name)!=null?c:o.$t("unknown-user")),1),i.bill.comment?(x(),b(k,{key:0},[Q,r("div",W,h(i.bill.comment),1)],64)):D("",!0)])])]),r("div",{class:$(["text-lg font-bold truncate flex-shrink-0 text-right",{"text-red-700":i.bill.type===a(B).Expenses,"text-green-900":i.bill.type===a(B).Income}])},h(i.bill.money),3)])}}});export{ee as _,te as a};
